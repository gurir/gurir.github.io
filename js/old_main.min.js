var t,at,ev,v1=0,step=100,v2=36,frame=1,v3=0,v4=0,v5=0,v6="",v7=0,v8=0,v9=!1,v10=0,v11=0,width=1920,height=1080,a_rotate=!0,v12=0,v13=!0,v14=!1,v14_id=0,v0="3D",v16=!1,coords={},coords_2D={},v17=!0,v18=!1,v19=pano?1280:data[section].width,v20=pano?720:data[section].height,r2dwidth=v19,r2dheight=v20,mode="all",v40=window.self!==window.top;v40=!1;var iconOpened=!1,devo=!1,v36=0,v35=!1,v37=!0,v38="",v39="",cb_active=!1,fov=60;data||console.log("penxheresi"),data.hasOwnProperty(section)&&(0==data[section].areas&&(v37=!1),data[section].hasOwnProperty("width_2d")&&(r2dwidth=data[section].width_2d,r2dheight=data[section].height_2d),data[section].hasOwnProperty("def_frame")&&(frame=parseInt(data[section].def_frame))),0==Cookies.get("a_rotate")&&(a_rotate=!1),pano&&($("#gback").attr("href",gback),$("#gback").show()),pano||0!=data[section].coords_3D.length||(mode="2d");var v21=0,v22=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(v22=!0);var isiOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;isiOS&&!v40&&$(".btn_toggle_fullscreen").addClass("inactive"),pano||0!=data[section].areas?0==(v21=pano?0:Object.keys(data[section].coords_2D).length)&&(v21=pano?0:Object.keys(data[section].coords_3D).length):v21=0;var appf="";for(pano||"floor"!=data[section].step||(appf="&f="+section_r+"&rf="+section),i=1;i<v21+1;i++)sold.includes("area_"+i)&&(v38=" area_sold"),$("#map").append('<area class="area'+v38+'" data-id="'+i+'" id="area_'+i+'" data-href="'+data[section].prefix+data[section].links["area_"+i]+'" data-info="true" shape="poly" coords="" />'),v38="";function v24(){clearInterval(at),$("#about").fadeOut()}$(function(){$("#viewer").swipe({swipeStatus:v23,tap:v28,doubleTap:v27}),step=$("#renders").width()/v2,$("#close").click(function(){$("#sidebar").animate({marginLeft:"-100%"},350),v14&&($("#icons ul").animate({marginLeft:0},350),iconOpened=!1)}),$("#openObject").click(function(){var e=$(this).attr("href");window.location.href=e+appf+"&p="+project}),$("#openInfo").click(function(){v31($(this).attr("data-id"),"#sec_obj_info")}),$(".btn_toggle_cb").click(function(e){e.preventDefault(),(cb_active=!cb_active)?(viewer.enableEffect(PANOLENS.Modes.STEREO),viewer.enableControl(PANOLENS.Controls.DEVICEORIENTATION),screenfull.enabled&&screenfull.request(),$("#menu").fadeOut("slow"),$("#gback").fadeOut("slow"),$("#close_cb").fadeIn("slow")):(viewer.enableEffect(PANOLENS.Modes.NORMAL),viewer.enableControl(PANOLENS.Controls.ORBIT),screenfull.enabled&&screenfull.exit(),$("#menu").fadeIn("slow"),$("#gback").fadeIn("slow"),$("#close_cb").fadeOut("slow"))}),$(".btn_toggle_v3d").click(function(){v17||(v14=!1,v14_id=0,v0="3D",$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_renders/"+frame+".jpg"),v30(),$("#svg").hide(),$(".btn_v").removeClass("active"),$(this).addClass("active"),a_rotate&&$("#pointer").show())}),$(".btn_toggle_v2dv").click(function(){v17||(v14=!1,v14_id=0,v0="2D","masterplan"==data[section].step&&"at-linda"==project&&width<720&&height<720&&v22&&(v39="_low"),$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_2d/img_ren"+v39+".jpg"),v30(),$("#svg").hide(),$(".btn_v").removeClass("active"),$(this).addClass("active"),a_rotate&&$("#pointer").hide())}),$(".btn_toggle_v2dt").click(function(){v17||(v14=!1,v14_id=0,v0="2D",$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_2d/img_tec.jpg"),v30(),$("#svg").hide(),$(".btn_v").removeClass("active"),$(this).addClass("active"),a_rotate&&$("#pointer").hide())}),$.get(base_url+"/assets/"+project+"/"+section+"_2d/img_tec.jpg").fail(function(){$(".btn_toggle_v2dt").addClass("inactive")}),$.get(base_url+"/assets/"+project+"/"+section+"_2d/img_ren.jpg").fail(function(){$(".btn_toggle_v2dv").addClass("inactive")}),0==v21&&$(".btn_toggle_sec").addClass("inactive"),$(".btn_toggle_fullscreen").click(function(){isiOS?isiOS&&v40&&window.parent.postMessage("fullscreen","*"):(screenfull.enabled&&screenfull.toggle(),screenfull.isFullscreen?$(this).removeClass("active"):$(this).addClass("active"))}),$(".btn_toggle_fav").click(function(){(v16=!v16)?$(this).html('<i class="fa fa-heart" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-heart-o" aria-hidden="true"></i>')}),$(".btn_toggle_sec").click(function(){v17||(v17=!0,v33=0,t=setInterval(v25,500/v21),v25())}),$(".btn_toggle_map").click(function(){v31(0,"#sec_map"),$("#gmap").show(),window.dispatchEvent(new Event("resize")),map.setCenter(uluru)}),$(".btn_toggle_list").click(function(){v31(0,"#sec_obj_all")}),$(".area").mouseover(function(e){if(!v22){var t=$(this).attr("data-id");if(v13&&!v14&&!v17){"3D"==v0?$("#polygon").attr("points",coords[$(this).attr("data-id")+"-"+frame]):"2D"==v0&&$("#polygon").attr("points",coords_2D[$(this).attr("data-id")]);var a="<h4>"+data[section].titles["area_"+t]+"</h4><table>";$.each(data[section].infos["area_"+t],function(e,t){var s=t.split(":");a+="<tr><td>"+s[0]+":</td><td>"+s[1]+"</td></tr>"}),a+="</table>",1!=t&&8!=t&&"masterplan"==data[section].step&&"at-linda"==project&&(a+="<p><br/><b>Së shpejti. Shih llamellën A dhe H.</b></p>"),$("#infobox").html(a),$("#infobox").show(),$(this).hasClass("area_sold")?$("#svg").addClass("svg_sold"):$("#svg").removeClass("svg_sold"),$("#svg").show()}}}).mouseout(function(){v14||v22||$("#svg").hide(),$("#infobox").hide()}),$("#s_masterplan").attr("href","/?s=situacioni&p="+project),pano||"masterplan"!=data[section].step?pano||"building"!=data[section].step?pano||"floor"!=data[section].step?pano||"apartment"!=data[section].step||($("#s_masterplan").addClass("s_prev"),$("#s_building").addClass("s_prev"),$("#s_floor").addClass("s_prev"),$("#s_apartment").addClass("s_current"),$("#s_building").attr("href","/?s="+bld+"&p="+project),$("#s_floor").attr("href","/?s="+flo+"&p="+project),$("#gback").attr("href","/?s="+flo+"&p="+project),$("#gback").show()):($("#s_masterplan").addClass("s_prev"),$("#s_building").addClass("s_prev"),$("#s_floor").addClass("s_current"),$("#s_apartment").addClass("s_next"),$("#s_building").attr("href","/?s="+data[section].parent+"&p="+project),$("#gback").attr("href","/?s="+data[section].parent+"&p="+project),$("#gback").show()):($("#s_masterplan").addClass("s_prev"),$("#s_building").addClass("s_current"),$("#s_floor").addClass("s_next"),$("#s_apartment").addClass("s_next"),$("#gback").attr("href","/?s=situacioni&p="+project),masterplan&&$("#gback").show()):($("#s_masterplan").addClass("s_current"),$("#s_building").addClass("s_next"),$("#s_floor").addClass("s_next"),$("#s_apartment").addClass("s_next"),"bp"==project&&($("#gback").attr("href","http://chelseapoint.net/"),$("#gback").show())),"2d"==mode?(tech_2d?$(".btn_toggle_v2dt").trigger("click"):$(".btn_toggle_v2dv").trigger("click"),$(".btn_toggle_v3d").addClass("inactive")):$(".btn_toggle_v3d").addClass("active"),$(document).contextmenu(function(e){debug||(e.preventDefault(),$("#about").css("top",e.pageY+10),$("#about").css("left",e.pageX-90),$("#about").fadeIn(),at=setInterval(v24,1500))}),$(".btn_zoom_plus").click(function(){viewer.getCamera().fov>30&&(viewer.getCamera().fov-=5,viewer.getCamera().updateProjectionMatrix())}),$(".btn_zoom_minus").click(function(){viewer.getCamera().fov<90&&(viewer.getCamera().fov+=5,viewer.getCamera().updateProjectionMatrix())}),$(".btn_toggle_do").click(function(){(devo=!devo)?(viewer.enableControl(PANOLENS.Controls.DEVICEORIENTATION),$(this).addClass("active")):(viewer.enableControl(PANOLENS.Controls.ORBIT),$(this).removeClass("active"))}),pano&&!v22&&$(".btn_toggle_do").addClass("inactive"),pano&&hfovfix(),debug&&($("#debug").show(),pano&&$("#dot").show())});var map,v33=0;function v25(){v33++,"3D"==v0?$("#polygon").attr("points",coords[v33+"-"+frame]):$("#polygon").attr("points",coords_2D[v33]),$("#svg").show(),v33==v21+1&&(clearInterval(t),$("#svg").hide(),v17=!1)}function v23(e,t,a,s,i,o,n,r){"3D"!=v0||v17||("left"!=r&&"right"!=r||(v35&&$(".hotspot").remove(),v13=!1,v9||(v9=!0,$("#svg").hide(),$("#icons ul").animate({marginLeft:-130},350),iconOpened=!1),(v7=r)!=v6&&(v3=v22?e.touches[0]?e.targetTouches[0].pageX:0:e.pageX),"right"==v7?(v8=s-v3)>step&&(++frame==v2+1&&(frame=1),v3=v10):(v8=v3-s)>step&&(0==--frame&&(frame=v2),v3=v10),v5=s,v6=v7,v26(),a_rotate&&(Cookies.set("a_rotate",0,{expires:1}),a_rotate=!1,$("#pointer").fadeOut())),"end"==t&&(ticks=1,v4=0,v6=0,v9=!1,v13=!0,v14=!1,v14_id=0,v29()))}function v26(){document.getElementById("renders").src=base_url+"/assets/"+project+"/"+section+"_renders/"+frame+".jpg"}function v28(e){for(var t=[],a=e.target;a!=document.body;)t.push(a),a=a.parentNode;null!=t[0].getAttribute("data-id")&&v13&&!v17?(v14=!0,t[0].getAttribute("data-id")==v14_id?window.location.href=data[section].prefix+data[section].links["area_"+t[0].getAttribute("data-id")]+appf+"&p="+project:(v14_id=t[0].getAttribute("data-id"),$("#sidebar").animate({marginLeft:"-100%"},350),v32(t[0].getAttribute("data-id")),"3D"==v0?$("#polygon").attr("points",coords[t[0].getAttribute("data-id")+"-"+frame]):$("#polygon").attr("points",coords_2D[t[0].getAttribute("data-id")]),$("#svg").show())):(v14=!1,v14_id=0,$("#icons ul").animate({marginLeft:-130},350),iconOpened=!1,$("#svg").hide())}function v27(e){for(var t=[],a=e.target;a!=document.body;)t.push(a),a=a.parentNode;null!=t[0].getAttribute("data-id")&&v13&&!v17&&""!=data[section].links["area_"+t[0].getAttribute("data-id")]&&(window.location.href=data[section].prefix+data[section].links["area_"+t[0].getAttribute("data-id")]+appf+"&p="+project)}function v29(){for(i=1;i<v21+1;i++)$("#area_"+i).attr("coords",coords[i+"-"+frame]);v35&&renderHotspots(),debug&&console.log(frame)}if(v29(),"all"!=mode||pano){if(!pano){v17=!1,$("#viewer").removeClass("blur"),$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_2d/img_ren.jpg"),(tmpImg=new Image).src=base_url+"/assets/"+project+"/"+section+"_2d/img_ren.jpg",tmpImg.onload=function(){$("#startup").fadeOut(),v30(),t=setInterval(v25,500/v21)}}}else{var loaded=0,n=0,c=0;for(i=1;i<37;i++){var tmpImg;n++,(tmpImg=new Image).src=base_url+"/assets/"+project+"/"+section+"_renders/"+i+".jpg",tmpImg.onload=function(){$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_renders/"+c+".jpg"),c++}}var interval=setInterval(function(){percent=n/100,loaded=Math.ceil(c/percent),$("#progress span").text(loaded),$("#progressbar_tick").css("width",loaded+"%"),100==loaded&&(clearInterval(interval),v30(),$("#viewer").removeClass("blur"),$("#renders").attr("src",base_url+"/assets/"+project+"/"+section+"_renders/"+frame+".jpg"),$("#startup").fadeOut(),a_rotate?($("#pointer").fadeIn(),$("#pointer").addClass("a_rotate")):$("#pointer").hide(),t=setInterval(v25,500/v21))},1)}function v30(){(v14=!1,v14_id=0,$("#icons ul").animate({marginLeft:-130},350),iconOpened=!1,pano)||($("#svg").hide(),$("#renders").css("width","auto"),$("#renders").height($(window).height()),$("#viewer").width($("#renders").width()),$("#viewer").css("left","50%"),$("#viewer").css("margin-left","-"+$("#viewer").width()/2+"px"),$("#viewer").css("margin-top","0"),width=$("#renders").width(),height=$("#renders").height(),width>$(window).width()&&($("#renders").width($(window).width()),$("#renders").css("height","auto"),width=$("#renders").width(),height=$("#renders").height(),$("#viewer").css("margin-top",($(window).height()-height)/2+"px"),$("#viewer").css("left","0"),$("#viewer").css("margin-left","0")),$("#viewer").width($("#renders").width()),$("#viewer").height($("#renders").height()),v36=(width-16*height/9)/2);if($("#viewer").height()<$("#menu").height()?($("#menu").addClass("menu_adapt"),isiOS&&$("#menu").addClass("menu_adapt_ios"),$("#menu").hasClass("menu_no3d")?$("#menu").removeClass("menu_no3d_mt"):$("#menu").addClass("menu_3d_mt"),$(".btn_toggle_map").hide()):($("#menu").removeClass("menu_adapt"),isiOS&&$("#menu").removeClass("menu_adapt_ios"),$("#menu").hasClass("menu_no3d")?$("#menu").addClass("menu_no3d_mt"):$("#menu").removeClass("menu_3d_mt"),$(".btn_toggle_map").show()),"3D"==v0){if("all"==mode&&v37){for(i=1;i<v21+1;i++)for(f=1;f<37;f++){var e=data[section].coords_3D["area_"+i][f],t=!1,a="",s=0;$.each(e,function(e,i){s=t?parseInt(width*i/v19)-pw_offset:parseInt(height*i/v20),a=a+","+s,t=!t}),coords[i+"-"+f]=a.substring(1)}v29()}}else if("2D"==v0)for(i=1;i<v21+1;i++){e=data[section].coords_2D["area_"+i],t=!1,a="",s=0;$.each(e,function(e,i){s=t?parseInt(width*i/r2dwidth):parseInt(height*i/r2dheight),a=a+","+s,t=!t}),coords_2D[i]=a.substring(1),$("#area_"+i).attr("coords",coords_2D[i])}if(!pano&&void 0!==data[section].hotspots)for(v21=Object.keys(data[section].hotspots).length,$(".hotspot").remove(),i=1;i<v21+1;i++){var o=parseInt(data[section].hotspots["area_"+i][0])*width/1280-30,n=parseInt(data[section].hotspots["area_"+i][1])*height/720-32;$("#viewer").append('<div data-href="'+data[section].links["area_"+i]+'" class="hotspot" style="top:'+n+"px;left:"+o+'px;"><img src="'+base_url+'/img/ripple.svg"/><div></div></div>')}pano||void 0===data[section].hotspots_3D||(v21=Object.keys(data[section].hotspots_3D).length,v35=!0,renderHotspots()),step=$("#renders").width()/v2}function renderHotspots(){if(!v22){$(".hotspot").remove();var e=0,t=0;$.each(data[section].hotspots_3D,function(a,s){t=s.y*height/720-32,$.each(s,function(i,o){i==frame&&(e=o*width/1280-32+v36,$("#viewer").append('<div data-id="'+a+'" class="hotspot hotspot_3d" data-href="'+s.url+'" style="left:'+e+"px;top:"+t+'px"><img src="'+base_url+'/img/ripple_2.svg"/><div></div></div>'))})})}}function v31(e,t){if($(".sec_side").hide(),$(t).show(),e>0){var a=data[section].prefix+data[section].links["area_"+e]+appf+"&p="+project;$("#view_object").attr("href",a),$("#sidebar h2").text(data[section].titles["area_"+e]);var s="<table>";$.each(data[section].infos["area_"+e],function(e,t){var a=t.split(":");s+="<tr><td>"+a[0]+":</td><td>"+a[1]+"</td></tr>"}),s+="</table>",""==data[section].links["area_"+e]&&"at-linda"==project&&(s+="<p><br/><b>Së shpejti. Shih llamellën A dhe H.</b></p>"),$("#sidebar p").html(s)}$("#sidebar").animate({marginLeft:0},350),$("#icons ul").animate({marginLeft:-130},350),iconOpened=!1}function v32(e){iconOpened&&$("#icons ul").css("margin-left","-100px");var t=data[section].prefix+data[section].links["area_"+e];""==data[section].links["area_"+e]?($("#openObject").addClass("btn_inactive"),$("#view_object").addClass("btn_inactive")):($("#openObject").removeClass("btn_inactive"),$("#view_object").removeClass("btn_inactive")),$("#openObject").attr("href",t),$("#openInfo").attr("data-id",e),$("#icons ul").animate({marginLeft:0},350),iconOpened=!0}function hfovfix(){p_height=window.innerHeight,p_width=window.innerWidth;p_width,p_height}function initMap(){map=new google.maps.Map(document.getElementById("gmap"),{zoom:16,center:uluru});new google.maps.Marker({position:uluru,map:map})}function hasTouch(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}if($(window).resize(function(){v30(),pano&&hfovfix()}),$(document).bind("touchmove",function(e){e.preventDefault(),v22&&(v10=parseInt(e.targetTouches[0].pageX),v11=parseInt(e.targetTouches[0].pageY))}),$(document).bind("mousemove",function(e){e.preventDefault(),v22||(v10=parseInt(e.pageX),v11=parseInt(e.pageY),$("#infobox").css("top",v11+40),$("#infobox").css("left",v10-150))}),$(document).on("click",".s_next",function(e){e.preventDefault()}),$(document).on("click",".s_current",function(e){e.preventDefault(),window.location.reload(!0)}),$(document).on("click",".hotspot",function(e){e.preventDefault(),$(this).hasClass("hotspot_3d")?window.location.href="http://int-virutaltour.chelseapoint.net/p/bernica-park/"+$(this).attr("data-href"):window.location.href=gback+"&v="+$(this).attr("data-href")}),$(document).on("click",".bi-hotspot",function(e){e.preventDefault(),"none"!=$(this).attr("data-href")&&(window.location.href=gback+"&v="+$(this).attr("data-href")+"&refh="+refh)}),hasTouch())try{for(var si in document.styleSheets){var styleSheet=document.styleSheets[si];if(styleSheet.rules)for(var ri=styleSheet.rules.length-1;ri>=0;ri--)styleSheet.rules[ri].selectorText&&styleSheet.rules[ri].selectorText.match(":hover")&&styleSheet.deleteRule(ri)}}catch(e){}function enableNoSleep(){noSleep.enable(),document.removeEventListener("click",enableNoSleep,!1)}
